Improved version of herbert framework

Look out! to speed things up you cannot have this same router function for different method